<div class="row">
  <div class="col" style="padding: 0 16px">
  <form [formGroup]="onboardingForm" #form=ngForm (ngSubmit)="onSubmit()">

    <!-- Connection Type -->
    <div>
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Connection Type</mat-label>
        <mat-select formControlName="connectionType" (selectionChange)="onConnectionTypeSelected()"
                    [(value)]="selectedConnectionType">
          <mat-option *ngFor="let connectionType of connectionTypes" [value]="connectionType">
            {{connectionType.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Request Type -->
    <div class="box">
      <mat-form-field appearance="outline" style="max-width: 20%">
        <mat-label>Request type</mat-label>
        <mat-select formControlName="connectionType" (selectionChange)="onRequestTypeSelected()">
          <mat-option *ngFor="let requestType of requestTypes" [value]="requestType">
            {{ requestType }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline" class="push" style="max-width: 100%; min-width: 75%">
        <mat-label>Endpoint URL</mat-label>
        <input type="text" matInput formControlName="endpointUrl">
      </mat-form-field>
    </div>

    <!-- Token -->
    <div *ngIf="onboardingForm.controls['token']">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Token</mat-label>
        <textarea type="text" matInput formControlName="token" rows="10"></textarea>
      </mat-form-field>
    </div>

    <!-- Username -->
    <div *ngIf="onboardingForm.controls['user']">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>User</mat-label>
        <input type="text" matInput formControlName="user">
      </mat-form-field>
    </div>

    <!-- Password -->
    <div *ngIf="onboardingForm.controls['password']">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Password</mat-label>
        <input type="password" matInput formControlName="password">
      </mat-form-field>
    </div>

    <!-- Header Params -->
    <div>
      <div>
        <mat-checkbox formControlName="customizeHeaders" (change)="onCustomizeHeadersSelectionChange()">Customize
          Headers?
        </mat-checkbox>
      </div>
    </div>
    <ng-container  *ngIf="onboardingForm.controls['headerParameters']" formArrayName="headerParameters">

      <ng-container *ngFor="let headerParam of headerParams.controls; let index = index">

        <div [formGroupName]="index">

          <mat-form-field appearance="outline">
            <mat-label>Key</mat-label>
            <input matInput type="text" formControlName="key"/>
          </mat-form-field>

          <mat-form-field appearance="outline" style="margin-left: 1em">
            <mat-label>Value</mat-label>
            <input matInput type="text" formControlName="value"/>
          </mat-form-field>

          <button mat-icon-button style="margin-left: 1em" aria-label="Remove Key Value" color="warn"
                  type="button"
                  matTooltip="Remove Parameter"
                  (click)="onDeleteHeaderParam(index)">
            <mat-icon>close</mat-icon>
          </button>

        </div>
      </ng-container>
      <button *ngIf="onboardingForm.controls['customizeHeaders']?.value === true"  type="button"
              mat-flat-button aria-label="Add Header Params" color="primary" (click)="addHeaderParam()">
        <mat-icon>add</mat-icon>
        Add Header Params
      </button>
    </ng-container>
    <!-- End Header Params -->

    <mat-divider class="top-margin"></mat-divider>

    <!-- Query Params -->
    <div>
      <div>
        <mat-checkbox formControlName="addQueryParams" (change)="onAddQueryParamsSelectionChange()">Add Query Params?
        </mat-checkbox>
      </div>
    </div>
    <ng-container  *ngIf="onboardingForm.controls['queryParameters']" formArrayName="queryParameters">

      <ng-container *ngFor="let queryParams of queryParams.controls; let index = index">

        <div [formGroupName]="index">

          <mat-form-field appearance="outline">
            <mat-label>Key</mat-label>
            <input matInput type="text" formControlName="key"/>
          </mat-form-field>

          <mat-form-field appearance="outline" style="margin-left: 1em">
            <mat-label>Value</mat-label>
            <input matInput type="text" formControlName="value"/>
          </mat-form-field>

          <button mat-icon-button style="margin-left: 1em" aria-label="Remove Key Value" color="warn"
                  type="button"
                  matTooltip="Remove Parameter"
                  (click)="onDeleteQueryParam(index)">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      </ng-container>

      <button *ngIf="onboardingForm.controls['addQueryParams']?.value === true" type="button"
              mat-flat-button aria-label="Add Query Params" color="primary" (click)="addQueryParam()">
        <mat-icon>add</mat-icon>
        Add Query Params
      </button>
    </ng-container>
    <!-- End Query Params -->

    <mat-divider class="top-margin"></mat-divider>

    <!-- Request Body -->
    <div>
      <div>
        <mat-checkbox formControlName="addRequestBody" (change)="onAddRequestBody()">Add Request Body?
        </mat-checkbox>
      </div>
    </div>
    <div *ngIf="onboardingForm.controls['requestBody']">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Request Body</mat-label>
        <textarea type="text" matInput formControlName="requestBody" rows="10"></textarea>
      </mat-form-field>
    </div>
    <!-- End Request Body -->
  </form>

  </div>
  <div class="col" style="padding: 0 16px">
    <div>
    <button mat-raised-button aria-label="Test Connection" color="primary" type="submit" (click)="onTestConnection()">
      <mat-icon>lan</mat-icon>
      Test Connection
    </button>
    </div>
    <mat-tab-group class="top-margin">
      <mat-tab label="First"><pre> {{ onboardingForm.value | json }} </pre></mat-tab>
      <mat-tab label="Second"> Content 2 </mat-tab>
      <mat-tab label="Third"> Content 3 </mat-tab>
    </mat-tab-group>
  </div>
  <!-- End Query Params -->



</div>

<div style="margin: 20px 20px">
  <lib-console [logs]="loggerData"></lib-console>
  <button mat-raised-button color="primary" (click)="logMessage('info')">Generate Info</button>
  <button mat-raised-button color="accent" (click)="logMessage('warn')">Generate Warning</button>
  <button mat-raised-button color="warn" (click)="logMessage('error')">Generate Error</button>
  <button mat-raised-button (click)="clearLog()">Clear Log</button>
</div>
